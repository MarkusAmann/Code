function X0 = X_init(X,p) 
X0 = 1/2*([p.x0(2); ...
    -p.l0(2)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*p.x0(2)^2 - p.l0(1)] + ...
    [X(2); ...
    -X(4)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*X(2)^2 - X(3)])*p.deltat + [p.x0.';p.l0.'] - X;
end