function F_eqns = eqns(X,p) % Gleichungen in Residuenform
F_eqns = 1/2*([X(2); ...
    -X(4)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*X(2)^2 - X(3)] + ...
    [X(6); ...
    -X(8)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*X(6)^2 - X(7)])*p.deltat + [X(1);X(2);X(3);X(4)] - [X(5);X(6);X(7);X(8)];
for k = 1:p.N-1
    F_eqns_k = 1/2*([X(4*k+2); ...
    -X(4*k+4)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*X(4*k+2)^2 - X(4*k+3)] + ...
    [X(4*(k+1)+2); ...
    -X(4*(k+1)+4)/(2*p.fx); ...
    0; ...
    -4*p.fy*p.kappa^2*X(4*(k+1)+2)^2 - X(4*(k+1)+3)])*p.deltat + ...
    [X(4*k+1);X(4*k+2);X(4*k+3);X(4*k+4)] - [X(4*(k+1)+1);X(4*(k+1)+2);X(4*(k+1)+3);X(4*(k+1)+4)];

    F_eqns = [F_eqns; F_eqns_k];
end
X_eqns_t0 = [X(1) - p.x0(1);...
    X(2) - p.x0(2)];
G_eqns_tf = [X(4*p.N+1) - p.sf;...
    X(4*p.N+4)];
F_eqns = [F_eqns; X_eqns_t0; G_eqns_tf];
end