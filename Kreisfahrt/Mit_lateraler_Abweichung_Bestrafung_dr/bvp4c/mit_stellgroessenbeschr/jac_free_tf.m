function [dFdX, dFdparam] = jac_free_tf(t,X,param,p)
dFdX = param*[% df1/dX
    0, cos(X(4))/(1-X(3)*p.kapparef), p.kapparef*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2, -X(2)*sin(X(4))/(1-X(3)*p.kapparef), 0, 0, 0, 0;...
    % df2/dX
    0, 0, 0, 0, 0, -1/p.fx, 0, 0;...
    % df3/dX
    0, sin(X(4)), 0, X(2)*cos(X(4)), 0, 0, 0, 0;...
    % df4/dX
    0, 2*X(8)/(p.fy*X(2)^3)-p.kapparef*cos(X(4))/(1-X(3)*p.kapparef), -p.kapparef^2*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2, p.kapparef*X(2)*sin(X(4))/(1-X(3)*p.kapparef), 0, 0, 0, -1/(p.fy*X(2)^2);...
    % df5/dX
    0, 0, 0, 0, 0, 0, 0, 0;...
    % df6/dX
    0, 4*X(8)^2/(p.fy*X(2)^3)-3*X(8)^2/(p.fy*X(2)^4), -p.kapparef*X(5)*cos(X(4))/(1-X(3)*p.kapparef)^2+p.kapparef^2*X(8)*cos(X(4))/(1-X(3)*p.kapparef)^2, X(5)*sin(X(4))/(1-X(3)*p.kapparef)-p.kapparef*X(8)*sin(X(4))/(1-X(3)*p.kapparef)-X(7)*cos(X(4)),...
    -cos(X(4))/(1-X(3)*p.kapparef), 0, -sin(X(4)), -4*X(8)/(p.fy*X(2)^2)+2*X(8)/(p.fy*X(2)^3)+p.kapparef*cos(X(4))/(1-X(3)*p.kapparef);...
    % df7/dX
    0, -p.kapparef*X(5)*cos(X(4))/(1-X(3)*p.kapparef)^2+p.kapparef^2*X(8)*cos(X(4))/(1-X(3)*p.kapparef)^2, -p.fr-2*p.kapparef^2*X(2)*X(5)*cos(X(4))/(1-X(3)*p.kapparef)^3+2*p.kapparef^3*X(2)*X(8)*cos(X(4))/(1-X(3)*p.kapparef)^3,...
    p.kapparef*X(2)*X(5)*sin(X(4))/(1-X(3)*p.kapparef)^2-p.kapparef^2*X(2)*X(8)*sin(X(4))/(1-X(3)*p.kapparef)^2, -p.kapparef*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2, 0, 0, p.kapparef^2*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2;...
    % df8/dX
    0, p.kapparef*X(5)*sin(X(4))/(1-X(3)*p.kapparef)-X(7)*cos(X(4))-p.kapparef*X(8)*sin(X(4))/(1-X(3)*p.kapparef), p.kapparef*X(2)*X(5)*sin(X(4))/(1-X(3)*p.kapparef)^2-p.kapparef^2*X(2)*X(8)*sin(X(4))/(1-X(3)*p.kapparef)^2,...
    X(2)*X(7)*sin(X(4))+X(2)*X(5)*cos(X(4))/(1-X(3)*p.kapparef)-p.kapparef*X(2)*X(8)*cos(X(4))/(1-X(3)*p.kapparef), X(2)*sin(X(4))/(1-X(3)*p.kapparef), 0, -X(2)*cos(X(4)), -p.kapparef*X(2)*sin(X(4))/(1-X(3)*p.kapparef)
    ];

dFdparam = [X(2)*cos(X(4))/(1-X(3)*p.kapparef);...
    -X(6)/p.fx;...
    X(2)*sin(X(4));...
    -X(8)/(p.fy*X(2)^2) - p.kapparef*X(2)*cos(X(4))/(1-X(3)*p.kapparef);...
    0;...
    -2*X(8)^2/(p.fy*X(2)^2) - X(5)*cos(X(4))/(1-X(3)*p.kapparef) - X(7)*sin(X(4)) + X(8)^2/(p.fy*X(2)^3) + X(8)*p.kapparef*cos(X(4))/(1-X(3)*p.kapparef);...
    -p.fr*X(3) - p.kapparef*X(5)*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2 + p.kapparef^2*X(8)*X(2)*cos(X(4))/(1-X(3)*p.kapparef)^2;...
    X(5)*X(2)*sin(X(4))/(1-X(3)*p.kapparef) - X(7)*X(2)*cos(X(4)) - p.kapparef*X(8)*X(2)*sin(X(4))/(1-X(3)*p.kapparef)];
end
